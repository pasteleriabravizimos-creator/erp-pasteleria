<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üç∞ ERP Pasteler√≠a SUPER COMPLETO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <style>
        body { margin: 0; font-family: -apple-system, sans-serif; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        @media print { .no-print { display: none; } }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        const ERP = () => {
            // Estados
            const [module, setModule] = useState('dashboard');
            const [config, setConfig] = useState({
                sheetId: localStorage.getItem('sheets_id') || '',
                apiKey: localStorage.getItem('api_key') || ''
            });
            
            // Datos
            const [ventas, setVentas] = useState([]);
            const [gastos, setGastos] = useState([]);
            const [personal, setPersonal] = useState([]);
            const [inventario, setInventario] = useState([]);
            const [productos, setProductos] = useState([]);
            const [clientes, setClientes] = useState([]);
            const [proveedores, setProveedores] = useState([]);
            const [servicios, setServicios] = useState([]);
            const [kds, setKds] = useState([]);
            const [delivery, setDelivery] = useState([]);
            
            // Filtros y estados
            const [filtroVentas, setFiltroVentas] = useState('todos');
            const [filtroGastos, setFiltroGastos] = useState('todos');
            const [ocrLoading, setOcrLoading] = useState(false);
            const [ocrData, setOcrData] = useState(null);

            // Sincronizaci√≥n
            const syncSheets = async () => {
                if (!config.sheetId || !config.apiKey) {
                    alert('‚ö†Ô∏è Configura Sheet ID y API Key en ‚öôÔ∏è Config');
                    setModule('config');
                    return;
                }

                const base = `https://sheets.googleapis.com/v4/spreadsheets/${config.sheetId}/values`;
                const key = `?key=${config.apiKey}`;
                const cargados = {};

                try {
                    // VENTAS
                    const rV = await fetch(`${base}/VENTAS!A2:R${key}`);
                    if (rV.ok) {
                        const d = await rV.json();
                        if (d.values && d.values.length > 0) {
                            setVentas(d.values.map((r, i) => ({
                                id: i+1, numero: r[0]||'', fechaEmision: r[1]||'', fechaEntrega: r[2]||'',
                                horaEntrega: r[3]||'', nPedido: r[4]||'', vendedor: r[5]||'', cliente: r[6]||'',
                                docIdentidad: r[7]||'', telefono: r[8]||'', moneda: r[9]||'PEN', monto: parseFloat(r[10])||0,
                                contacto: r[11]||'', nContacto: r[12]||'', saldo: parseFloat(r[13])||0, direccion: r[14]||'',
                                distrito: r[15]||'', observaciones: r[16]||'', estado: r[17]||'PENDIENTE'
                            })));
                            cargados.ventas = d.values.length;
                        }
                    }

                    // GASTOS
                    const rG = await fetch(`${base}/GASTOS!A2:K${key}`);
                    if (rG.ok) {
                        const d = await rG.json();
                        if (d.values && d.values.length > 0) {
                            setGastos(d.values.map((r, i) => ({
                                id: i+1, periodo: r[0]||'', area: r[1]||'', razonSocial: r[2]||'',
                                tipoDoc: r[3]||'', serie: r[4]||'', numero: r[5]||'', descripcion: r[6]||'',
                                monto: parseFloat(r[7])||0, pendiente: parseFloat(r[8])||0, medio: r[9]||'', obs: r[10]||''
                            })));
                            cargados.gastos = d.values.length;
                        }
                    }

                    // PERSONAL
                    const rP = await fetch(`${base}/PERSONAL!A2:K${key}`);
                    if (rP.ok) {
                        const d = await rP.json();
                        if (d.values && d.values.length > 0) {
                            setPersonal(d.values.map((r, i) => ({
                                id: i+1, nombre: r[0]||'', cargo: r[1]||'', sueldoBase: parseFloat(r[2])||0,
                                afp: parseFloat(r[3])||0, renta5ta: parseFloat(r[4])||0, planilla: r[6]==='SI',
                                rrxhh: r[7]==='SI', ultimoPago: r[8]||'', tipoPago: r[9]||'MENSUAL', estado: r[10]||'PENDIENTE'
                            })));
                            cargados.personal = d.values.length;
                        }
                    }

                    // INVENTARIO
                    const rI = await fetch(`${base}/INVENTARIO!A2:I${key}`);
                    if (rI.ok) {
                        const d = await rI.json();
                        if (d.values && d.values.length > 0) {
                            setInventario(d.values.map((r, i) => ({
                                id: i+1, codigo: r[0]||'', nombre: r[1]||'', stock: parseFloat(r[2])||0,
                                unidad: r[3]||'', costo: parseFloat(r[4])||0, valorTotal: parseFloat(r[5])||0,
                                stockMin: parseFloat(r[6])||0, proveedor: r[7]||'', estadoStock: r[8]||''
                            })));
                            cargados.inventario = d.values.length;
                        }
                    }

                    // PRODUCTOS
                    const rPr = await fetch(`${base}/PRODUCTOS!A2:L${key}`);
                    if (rPr.ok) {
                        const d = await rPr.json();
                        if (d.values && d.values.length > 0) {
                            setProductos(d.values.map((r, i) => ({
                                id: i+1, codigo: r[0]||'', nombre: r[1]||'', precio: parseFloat(r[2])||0,
                                categoria: r[3]||'', insumo1: r[4]||'', cant1: parseFloat(r[5])||0,
                                insumo2: r[6]||'', cant2: parseFloat(r[7])||0, insumo3: r[8]||'', cant3: parseFloat(r[9])||0,
                                insumo4: r[10]||'', cant4: parseFloat(r[11])||0
                            })));
                            cargados.productos = d.values.length;
                        }
                    }

                    // CLIENTES
                    const rC = await fetch(`${base}/CLIENTES!A2:I${key}`);
                    if (rC.ok) {
                        const d = await rC.json();
                        if (d.values && d.values.length > 0) {
                            setClientes(d.values.map((r, i) => ({
                                id: i+1, ruc: r[0]||'', razonSocial: r[1]||'', telefono: r[2]||'', distrito: r[3]||'',
                                totalCompras: parseFloat(r[4])||0, cantCompras: parseInt(r[5])||0,
                                ultimaCompra: r[6]||'', tipo: r[7]||'PERSONA', estado: r[8]||'ACTIVO'
                            })));
                            cargados.clientes = d.values.length;
                        }
                    }

                    // PROVEEDORES
                    const rPv = await fetch(`${base}/PROVEEDORES!A2:G${key}`);
                    if (rPv.ok) {
                        const d = await rPv.json();
                        if (d.values && d.values.length > 0) {
                            setProveedores(d.values.map((r, i) => ({
                                id: i+1, ruc: r[0]||'', razonSocial: r[1]||'', telefono: r[2]||'', categoria: r[3]||'',
                                totalComprado: parseFloat(r[4])||0, cantCompras: parseInt(r[5])||0, ultimaCompra: r[6]||''
                            })));
                            cargados.proveedores = d.values.length;
                        }
                    }

                    // SERVICIOS
                    const rS = await fetch(`${base}/SERVICIOS!A2:H${key}`);
                    if (rS.ok) {
                        const d = await rS.json();
                        if (d.values && d.values.length > 0) {
                            setServicios(d.values.map((r, i) => ({
                                id: i+1, servicio: r[0]||'', monto: parseFloat(r[1])||0, vencimiento: r[2]||'',
                                pagado: parseFloat(r[3])||0, pendiente: parseFloat(r[4])||0,
                                medioPago: r[5]||'', estado: r[6]||'PENDIENTE', alerta: r[7]||''
                            })));
                            cargados.servicios = d.values.length;
                        }
                    }

                    // KDS
                    const rK = await fetch(`${base}/KDS!A2:H${key}`);
                    if (rK.ok) {
                        const d = await rK.json();
                        if (d.values && d.values.length > 0) {
                            setKds(d.values.map((r, i) => ({
                                id: i+1, hora: r[0]||'', nPedido: r[1]||'', cliente: r[2]||'', productos: r[3]||'',
                                cantidad: parseInt(r[4])||0, prioridad: r[5]||'MEDIA', estado: r[6]||'PENDIENTE', horaEntrega: r[7]||''
                            })));
                            cargados.kds = d.values.length;
                        }
                    }

                    // DELIVERY
                    const rD = await fetch(`${base}/DELIVERY!A2:J${key}`);
                    if (rD.ok) {
                        const d = await rD.json();
                        if (d.values && d.values.length > 0) {
                            setDelivery(d.values.map((r, i) => ({
                                id: i+1, fecha: r[0]||'', nPedido: r[1]||'', delivery: r[2]||'', tipo: r[3]||'',
                                destino: r[4]||'', costo: parseFloat(r[5])||0, cobradoCliente: parseFloat(r[6])||0,
                                horaSalida: r[7]||'', horaEntrega: r[8]||'', ganancia: parseFloat(r[9])||0
                            })));
                            cargados.delivery = d.values.length;
                        }
                    }

                    const msg = `‚úÖ Sincronizaci√≥n exitosa!\n\nüìä Registros cargados:\n${Object.entries(cargados).map(([k,v]) => `${k}: ${v}`).join('\n')}`;
                    alert(msg);
                } catch (e) {
                    alert('‚ùå Error: ' + e.message);
                }
            };

            // OCR para facturas
            const procesarFactura = async (file) => {
                setOcrLoading(true);
                try {
                    const result = await Tesseract.recognize(file, 'spa');
                    const texto = result.data.text;
                    
                    const ruc = texto.match(/RUC[:\s]*(\d{11})/i)?.[1] || '';
                    const razon = texto.match(/RAZ[O√ì]N\s+SOCIAL[:\s]*(.+)/i)?.[1]?.trim() || '';
                    const monto = texto.match(/TOTAL[:\s]*S\/?\s*(\d+\.?\d*)/i)?.[1] || '';
                    const fecha = texto.match(/FECHA[:\s]*(\d{2}\/\d{2}\/\d{4})/i)?.[1] || '';
                    
                    setOcrData({ ruc, razonSocial: razon, monto: parseFloat(monto) || 0, fecha });
                    alert(`üì∏ Datos extra√≠dos:\n\nRUC: ${ruc}\nRaz√≥n Social: ${razon}\nMonto: S/ ${monto}\nFecha: ${fecha}`);
                } catch (e) {
                    alert('‚ùå Error OCR: ' + e.message);
                } finally {
                    setOcrLoading(false);
                }
            };

            // C√°lculos
            const ventasFiltradas = ventas.filter(v => {
                if (filtroVentas === 'ruc') return v.docIdentidad?.length === 11;
                if (filtroVentas === 'principal') return v.monto > 100;
                return true;
            });

            const gastosFiltrados = gastos.filter(g => {
                if (filtroGastos === 'ruc') return g.razonSocial?.length > 20;
                if (filtroGastos === 'principal') return g.monto > 500;
                return true;
            });

            const totalIngresos = ventasFiltradas.reduce((s, v) => s + v.monto, 0);
            const totalGastos = gastosFiltrados.reduce((s, g) => s + g.monto, 0);
            const balance = totalIngresos - totalGastos;
            const cuentasPorCobrar = ventas.filter(v => v.saldo > 0);
            const totalPorCobrar = cuentasPorCobrar.reduce((s, c) => s + c.saldo, 0);
            const totalServiciosPendientes = servicios.reduce((s, v) => s + v.pendiente, 0);

            // Ranking vendedoras
            const rankingVendedoras = useMemo(() => {
                const map = {};
                ventasFiltradas.forEach(v => {
                    if (!map[v.vendedor]) map[v.vendedor] = 0;
                    map[v.vendedor] += v.monto;
                });
                return Object.entries(map).sort((a, b) => b[1] - a[1]).slice(0, 5);
            }, [ventasFiltradas]);

            // Ranking distritos
            const rankingDistritos = useMemo(() => {
                const map = {};
                ventasFiltradas.forEach(v => {
                    if (!map[v.distrito]) map[v.distrito] = 0;
                    map[v.distrito] += v.monto;
                });
                return Object.entries(map).sort((a, b) => b[1] - a[1]).slice(0, 5);
            }, [ventasFiltradas]);

            // Gastos por categor√≠a
            const gastosPorCategoria = useMemo(() => {
                const map = {};
                gastosFiltrados.forEach(g => {
                    if (!map[g.area]) map[g.area] = 0;
                    map[g.area] += g.monto;
                });
                return Object.entries(map).sort((a, b) => b[1] - a[1]).slice(0, 5);
            }, [gastosFiltrados]);

            return (
                <div className="min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50">
                    {/* Header */}
                    <div className="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-4 shadow-lg no-print">
                        <div className="container mx-auto flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <span className="text-3xl">üç∞</span>
                                <div>
                                    <h1 className="text-xl font-bold">ERP PASTELER√çA SUPER COMPLETO</h1>
                                    <p className="text-xs opacity-90">Sistema Integrado de Gesti√≥n Empresarial</p>
                                </div>
                            </div>
                            <button onClick={syncSheets} className="bg-white text-indigo-600 px-4 py-2 rounded-lg font-bold hover:bg-indigo-50 transition">
                                üîÑ Sincronizar
                            </button>
                        </div>
                    </div>

                    {/* Menu */}
                    <div className="bg-white border-b sticky top-0 z-10 shadow-sm no-print overflow-x-auto">
                        <div className="container mx-auto flex gap-2 p-2">
                            {[
                                {id: 'dashboard', icon: 'üìä', label: 'Dashboard'},
                                {id: 'ventas', icon: 'üí∞', label: 'Ingresos'},
                                {id: 'gastos', icon: 'üí∏', label: 'Gastos'},
                                {id: 'personal', icon: 'üë•', label: 'Personal'},
                                {id: 'clientes', icon: 'üë§', label: 'Clientes'},
                                {id: 'inventario', icon: 'üì¶', label: 'Inventario'},
                                {id: 'productos', icon: 'üç∞', label: 'Productos'},
                                {id: 'proveedores', icon: 'üè≠', label: 'Proveedores'},
                                {id: 'servicios', icon: '‚ö°', label: 'Servicios'},
                                {id: 'kds', icon: 'üë®‚Äçüç≥', label: 'KDS'},
                                {id: 'delivery', icon: 'üöó', label: 'Delivery'},
                                {id: 'cuentas', icon: 'üí≥', label: 'x Cobrar'},
                                {id: 'graficos', icon: 'üìà', label: 'Gr√°ficos'},
                                {id: 'ocr', icon: 'üì∏', label: 'Scan'},
                                {id: 'config', icon: '‚öôÔ∏è', label: 'Config'}
                            ].map(m => (
                                <button key={m.id} onClick={() => setModule(m.id)}
                                    className={`px-3 py-2 rounded-lg font-semibold whitespace-nowrap transition text-sm ${
                                        module === m.id ? 'bg-indigo-600 text-white' : 'bg-gray-100 hover:bg-gray-200'
                                    }`}>
                                    {m.icon} {m.label}
                                </button>
                            ))}
                        </div>
                    </div>

                    {/* Contenido */}
                    <div className="container mx-auto p-4">
                        {/* DASHBOARD */}
                        {module === 'dashboard' && (
                            <div className="space-y-6">
                                <h2 className="text-2xl font-bold">üìä Dashboard Principal</h2>
                                
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                                    <div className="bg-gradient-to-br from-green-500 to-green-600 text-white p-6 rounded-xl shadow-lg">
                                        <div className="text-4xl mb-2">üí∞</div>
                                        <div className="text-3xl font-bold">S/ {totalIngresos.toFixed(2)}</div>
                                        <div className="text-sm opacity-90">Ingresos</div>
                                        <div className="text-xs mt-2">{ventasFiltradas.length} ventas</div>
                                    </div>
                                    <div className="bg-gradient-to-br from-red-500 to-red-600 text-white p-6 rounded-xl shadow-lg">
                                        <div className="text-4xl mb-2">üí∏</div>
                                        <div className="text-3xl font-bold">S/ {totalGastos.toFixed(2)}</div>
                                        <div className="text-sm opacity-90">Gastos</div>
                                        <div className="text-xs mt-2">{gastosFiltrados.length} registros</div>
                                    </div>
                                    <div className={`bg-gradient-to-br ${balance >= 0 ? 'from-blue-500 to-blue-600' : 'from-orange-500 to-orange-600'} text-white p-6 rounded-xl shadow-lg`}>
                                        <div className="text-4xl mb-2">üìä</div>
                                        <div className="text-3xl font-bold">S/ {balance.toFixed(2)}</div>
                                        <div className="text-sm opacity-90">Balance</div>
                                        <div className="text-xs mt-2">{balance >= 0 ? '‚úÖ Positivo' : '‚ö†Ô∏è Negativo'}</div>
                                    </div>
                                    <div className="bg-gradient-to-br from-purple-500 to-purple-600 text-white p-6 rounded-xl shadow-lg">
                                        <div className="text-4xl mb-2">üí≥</div>
                                        <div className="text-3xl font-bold">S/ {totalPorCobrar.toFixed(2)}</div>
                                        <div className="text-sm opacity-90">Por Cobrar</div>
                                        <div className="text-xs mt-2">{cuentasPorCobrar.length} cuentas</div>
                                    </div>
                                    <div className="bg-gradient-to-br from-yellow-500 to-yellow-600 text-white p-6 rounded-xl shadow-lg">
                                        <div className="text-4xl mb-2">üë®‚Äçüç≥</div>
                                        <div className="text-3xl font-bold">{kds.length}</div>
                                        <div className="text-sm opacity-90">Pedidos</div>
                                        <div className="text-xs mt-2">En cocina</div>
                                    </div>
                                    <div className="bg-gradient-to-br from-pink-500 to-pink-600 text-white p-6 rounded-xl shadow-lg">
                                        <div className="text-4xl mb-2">üì¶</div>
                                        <div className="text-3xl font-bold">{inventario.filter(i => i.stock <= i.stockMin).length}</div>
                                        <div className="text-sm opacity-90">Stock Bajo</div>
                                        <div className="text-xs mt-2">Alertas cr√≠ticas</div>
                                    </div>
                                    <div className="bg-gradient-to-br from-cyan-500 to-cyan-600 text-white p-6 rounded-xl shadow-lg">
                                        <div className="text-4xl mb-2">‚ö°</div>
                                        <div className="text-3xl font-bold">S/ {totalServiciosPendientes.toFixed(2)}</div>
                                        <div className="text-sm opacity-90">Servicios</div>
                                        <div className="text-xs mt-2">Por pagar</div>
                                    </div>
                                    <div className="bg-gradient-to-br from-lime-500 to-lime-600 text-white p-6 rounded-xl shadow-lg">
                                        <div className="text-4xl mb-2">üë•</div>
                                        <div className="text-3xl font-bold">{personal.length}</div>
                                        <div className="text-sm opacity-90">Personal</div>
                                        <div className="text-xs mt-2">Empleados activos</div>
                                    </div>
                                </div>

                                {/* Rankings */}
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div className="bg-white p-6 rounded-lg shadow">
                                        <h3 className="font-bold mb-4">üèÜ Ranking Vendedoras</h3>
                                        {rankingVendedoras.length > 0 ? (
                                            <div className="space-y-2">
                                                {rankingVendedoras.map(([v, m], i) => (
                                                    <div key={v} className="flex justify-between items-center p-2 bg-gray-50 rounded">
                                                        <span className="font-semibold">{i+1}. {v}</span>
                                                        <span className="text-green-600 font-bold">S/ {m.toFixed(2)}</span>
                                                    </div>
                                                ))}
                                            </div>
                                        ) : <p className="text-gray-500">Sin datos</p>}
                                    </div>

                                    <div className="bg-white p-6 rounded-lg shadow">
                                        <h3 className="font-bold mb-4">üìç Ranking Distritos</h3>
                                        {rankingDistritos.length > 0 ? (
                                            <div className="space-y-2">
                                                {rankingDistritos.map(([d, m], i) => (
                                                    <div key={d} className="flex justify-between items-center p-2 bg-gray-50 rounded">
                                                        <span className="font-semibold">{i+1}. {d}</span>
                                                        <span className="text-blue-600 font-bold">S/ {m.toFixed(2)}</span>
                                                    </div>
                                                ))}
                                            </div>
                                        ) : <p className="text-gray-500">Sin datos</p>}
                                    </div>
                                </div>

                                {/* Gastos por categor√≠a */}
                                <div className="bg-white p-6 rounded-lg shadow">
                                    <h3 className="font-bold mb-4">üí∏ Gastos por Categor√≠a</h3>
                                    {gastosPorCategoria.length > 0 ? (
                                        <div className="space-y-2">
                                            {gastosPorCategoria.map(([c, m]) => (
                                                <div key={c} className="flex justify-between items-center p-2 bg-gray-50 rounded">
                                                    <span className="font-semibold">{c}</span>
                                                    <span className="text-red-600 font-bold">S/ {m.toFixed(2)}</span>
                                                </div>
                                            ))}
                                        </div>
                                    ) : <p className="text-gray-500">Sin datos</p>}
                                </div>

                                {/* Alertas */}
                                <div className="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded">
                                    <div className="font-bold mb-2">‚ö†Ô∏è Alertas Importantes</div>
                                    <ul className="space-y-1 text-sm">
                                        {totalPorCobrar > 0 && <li>‚Ä¢ Cuentas por cobrar: S/ {totalPorCobrar.toFixed(2)}</li>}
                                        {totalServiciosPendientes > 0 && <li>‚Ä¢ Servicios pendientes: S/ {totalServiciosPendientes.toFixed(2)}</li>}
                                        {inventario.filter(i => i.stock <= i.stockMin).length > 0 && 
                                            <li>‚Ä¢ {inventario.filter(i => i.stock <= i.stockMin).length} insumos con stock cr√≠tico</li>}
                                        {kds.length > 0 && <li>‚Ä¢ {kds.length} pedidos en cocina pendientes</li>}
                                    </ul>
                                </div>
                            </div>
                        )}

                        {/* VENTAS */}
                        {module === 'ventas' && (
                            <div className="space-y-4">
                                <div className="flex justify-between items-center">
                                    <h2 className="text-2xl font-bold">üí∞ Reporte de Ventas</h2>
                                    <select value={filtroVentas} onChange={(e) => setFiltroVentas(e.target.value)}
                                        className="px-4 py-2 border rounded-lg">
                                        <option value="todos">Todas las ventas</option>
                                        <option value="ruc">Solo RUC (Empresas)</option>
                                        <option value="principal">Cuenta Principal (&gt; S/100)</option>
                                    </select>
                                </div>
                                
                                <div className="bg-white rounded-lg shadow overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead className="bg-green-600 text-white">
                                            <tr>
                                                <th className="p-3 text-left">Pedido</th>
                                                <th className="p-3 text-left">Cliente</th>
                                                <th className="p-3 text-left">Vendedor/a</th>
                                                <th className="p-3 text-left">Distrito</th>
                                                <th className="p-3 text-right">Monto</th>
                                                <th className="p-3 text-right">Saldo</th>
                                                <th className="p-3 text-center">Estado</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {ventasFiltradas.slice(0, 50).map(v => (
                                                <tr key={v.id} className="border-b hover:bg-gray-50">
                                                    <td className="p-3 font-mono text-xs">{v.nPedido}</td>
                                                    <td className="p-3">{v.cliente}</td>
                                                    <td className="p-3">{v.vendedor}</td>
                                                    <td className="p-3 text-xs">{v.distrito}</td>
                                                    <td className="p-3 text-right font-bold text-green-600">S/ {v.monto.toFixed(2)}</td>
                                                    <td className="p-3 text-right font-bold text-red-600">S/ {v.saldo.toFixed(2)}</td>
                                                    <td className="p-3 text-center">
                                                        <span className={`px-2 py-1 rounded text-xs ${
                                                            v.estado === 'PROCESADO' ? 'bg-green-100 text-green-800' : 
                                                            v.estado === 'ENTREGADO' ? 'bg-blue-100 text-blue-800' :
                                                            'bg-yellow-100 text-yellow-800'
                                                        }`}>{v.estado}</span>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {/* GASTOS */}
                        {module === 'gastos' && (
                            <div className="space-y-4">
                                <div className="flex justify-between items-center">
                                    <h2 className="text-2xl font-bold">üí∏ Reporte de Gastos</h2>
                                    <select value={filtroGastos} onChange={(e) => setFiltroGastos(e.target.value)}
                                        className="px-4 py-2 border rounded-lg">
                                        <option value="todos">Todos los gastos</option>
                                        <option value="ruc">Solo RUC (Empresas)</option>
                                        <option value="principal">Cuenta Principal (&gt; S/500)</option>
                                    </select>
                                </div>
                                
                                <div className="bg-white rounded-lg shadow overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead className="bg-red-600 text-white">
                                            <tr>
                                                <th className="p-3 text-left">Proveedor</th>
                                                <th className="p-3 text-left">√Årea</th>
                                                <th className="p-3 text-left">Documento</th>
                                                <th className="p-3 text-right">Monto</th>
                                                <th className="p-3 text-right">Pendiente</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {gastosFiltrados.slice(0, 50).map(g => (
                                                <tr key={g.id} className="border-b hover:bg-gray-50">
                                                    <td className="p-3">{g.razonSocial}</td>
                                                    <td className="p-3"><span className="px-2 py-1 bg-gray-100 rounded text-xs">{g.area}</span></td>
                                                    <td className="p-3 font-mono text-xs">{g.serie}-{g.numero}</td>
                                                    <td className="p-3 text-right font-bold">S/ {g.monto.toFixed(2)}</td>
                                                    <td className="p-3 text-right font-bold text-red-600">S/ {g.pendiente.toFixed(2)}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {/* PERSONAL */}
                        {module === 'personal' && (
                            <div className="space-y-4">
                                <h2 className="text-2xl font-bold">üë• Gesti√≥n de Personal</h2>
                                <div className="bg-white rounded-lg shadow overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead className="bg-blue-600 text-white">
                                            <tr>
                                                <th className="p-3 text-left">Nombre</th>
                                                <th className="p-3 text-left">Cargo</th>
                                                <th className="p-3 text-right">Sueldo Base</th>
                                                <th className="p-3 text-right">AFP</th>
                                                <th className="p-3 text-center">Planilla</th>
                                                <th className="p-3 text-center">Estado</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {personal.map(p => (
                                                <tr key={p.id} className="border-b hover:bg-gray-50">
                                                    <td className="p-3 font-semibold">{p.nombre}</td>
                                                    <td className="p-3">{p.cargo}</td>
                                                    <td className="p-3 text-right">S/ {p.sueldoBase.toFixed(2)}</td>
                                                    <td className="p-3 text-right">S/ {p.afp.toFixed(2)}</td>
                                                    <td className="p-3 text-center">{p.planilla ? '‚úÖ' : '‚ùå'}</td>
                                                    <td className="p-3 text-center">
                                                        <span className={`px-2 py-1 rounded text-xs ${
                                                            p.estado === 'PAGADO' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'
                                                        }`}>{p.estado}</span>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {/* CLIENTES */}
                        {module === 'clientes' && (
                            <div className="space-y-4">
                                <h2 className="text-2xl font-bold">üë§ Base de Clientes</h2>
                                <div className="bg-white rounded-lg shadow overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead className="bg-indigo-600 text-white">
                                            <tr>
                                                <th className="p-3 text-left">RUC/DNI</th>
                                                <th className="p-3 text-left">Raz√≥n Social</th>
                                                <th className="p-3 text-left">Distrito</th>
                                                <th className="p-3 text-right">Total Compras</th>
                                                <th className="p-3 text-center">Cant</th>
                                                <th className="p-3 text-center">Tipo</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {clientes.slice(0, 50).map(c => (
                                                <tr key={c.id} className="border-b hover:bg-gray-50">
                                                    <td className="p-3 font-mono text-xs">{c.ruc}</td>
                                                    <td className="p-3">{c.razonSocial}</td>
                                                    <td className="p-3">{c.distrito}</td>
                                                    <td className="p-3 text-right font-bold text-green-600">S/ {c.totalCompras.toFixed(2)}</td>
                                                    <td className="p-3 text-center">{c.cantCompras}</td>
                                                    <td className="p-3 text-center">
                                                        <span className={`px-2 py-1 rounded text-xs ${
                                                            c.tipo === 'EMPRESA' ? 'bg-blue-100 text-blue-800' : 'bg-gray-100 text-gray-800'
                                                        }`}>{c.tipo}</span>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {/* INVENTARIO */}
                        {module === 'inventario' && (
                            <div className="space-y-4">
                                <h2 className="text-2xl font-bold">üì¶ Inventario de Insumos</h2>
                                <div className="bg-white rounded-lg shadow overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead className="bg-orange-600 text-white">
                                            <tr>
                                                <th className="p-3 text-left">Insumo</th>
                                                <th className="p-3 text-center">Stock</th>
                                                <th className="p-3 text-center">Unidad</th>
                                                <th className="p-3 text-right">Costo</th>
                                                <th className="p-3 text-left">Usado en</th>
                                                <th className="p-3 text-center">Estado</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {inventario.slice(0, 50).map(inv => {
                                                const productosQueUsan = productos.filter(p => 
                                                    p.insumo1 === inv.nombre || p.insumo2 === inv.nombre || 
                                                    p.insumo3 === inv.nombre || p.insumo4 === inv.nombre
                                                );
                                                
                                                return (
                                                    <tr key={inv.id} className="border-b hover:bg-gray-50">
                                                        <td className="p-3 font-semibold">{inv.nombre}</td>
                                                        <td className="p-3 text-center font-bold">{inv.stock}</td>
                                                        <td className="p-3 text-center text-gray-600">{inv.unidad}</td>
                                                        <td className="p-3 text-right">S/ {inv.costo.toFixed(2)}</td>
                                                        <td className="p-3">
                                                            {productosQueUsan.length > 0 ? (
                                                                <details className="cursor-pointer">
                                                                    <summary className="text-blue-600 hover:underline text-xs">
                                                                        {productosQueUsan.length} productos
                                                                    </summary>
                                                                    <ul className="mt-2 text-xs space-y-1 pl-4">
                                                                        {productosQueUsan.map(p => (
                                                                            <li key={p.id}>‚Ä¢ {p.nombre}</li>
                                                                        ))}
                                                                    </ul>
                                                                </details>
                                                            ) : (
                                                                <span className="text-xs text-gray-400">No usado</span>
                                                            )}
                                                        </td>
                                                        <td className="p-3 text-center">
                                                            <span className={`px-2 py-1 rounded text-xs font-bold ${
                                                                inv.stock <= inv.stockMin ? 'bg-red-100 text-red-800' :
                                                                inv.stock <= inv.stockMin * 2 ? 'bg-yellow-100 text-yellow-800' :
                                                                'bg-green-100 text-green-800'
                                                            }`}>
                                                                {inv.stock <= inv.stockMin ? 'üî¥ CR√çTICO' :
                                                                 inv.stock <= inv.stockMin * 2 ? 'üü° BAJO' : 'üü¢ OK'}
                                                            </span>
                                                        </td>
                                                    </tr>
                                                );
                                            })}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {/* PRODUCTOS */}
                        {module === 'productos' && (
                            <div className="space-y-4">
                                <h2 className="text-2xl font-bold">üç∞ Cat√°logo de Productos</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    {productos.slice(0, 30).map(p => (
                                        <div key={p.id} className="bg-white p-4 rounded-lg shadow hover:shadow-lg transition">
                                            <div className="flex justify-between items-start mb-2">
                                                <h3 className="font-bold text-lg">{p.nombre}</h3>
                                                <span className="text-green-600 font-bold text-xl">S/ {p.precio.toFixed(2)}</span>
                                            </div>
                                            <div className="text-xs text-gray-600 mb-3">{p.categoria}</div>
                                            <div className="bg-gray-50 p-2 rounded">
                                                <p className="text-xs font-bold mb-1">Receta:</p>
                                                {p.insumo1 && <p className="text-xs">‚Ä¢ {p.insumo1}: {p.cant1}</p>}
                                                {p.insumo2 && <p className="text-xs">‚Ä¢ {p.insumo2}: {p.cant2}</p>}
                                                {p.insumo3 && <p className="text-xs">‚Ä¢ {p.insumo3}: {p.cant3}</p>}
                                                {p.insumo4 && <p className="text-xs">‚Ä¢ {p.insumo4}: {p.cant4}</p>}
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* PROVEEDORES */}
                        {module === 'proveedores' && (
                            <div className="space-y-4">
                                <h2 className="text-2xl font-bold">üè≠ Directorio de Proveedores</h2>
                                <div className="bg-white rounded-lg shadow overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead className="bg-teal-600 text-white">
                                            <tr>
                                                <th className="p-3 text-left">RUC</th>
                                                <th className="p-3 text-left">Raz√≥n Social</th>
                                                <th className="p-3 text-left">Categor√≠a</th>
                                                <th className="p-3 text-right">Total Comprado</th>
                                                <th className="p-3 text-center">Cant</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {proveedores.map(p => (
                                                <tr key={p.id} className="border-b hover:bg-gray-50">
                                                    <td className="p-3 font-mono text-xs">{p.ruc}</td>
                                                    <td className="p-3 font-semibold">{p.razonSocial}</td>
                                                    <td className="p-3"><span className="px-2 py-1 bg-gray-100 rounded text-xs">{p.categoria}</span></td>
                                                    <td className="p-3 text-right font-bold">S/ {p.totalComprado.toFixed(2)}</td>
                                                    <td className="p-3 text-center">{p.cantCompras}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {/* SERVICIOS */}
                        {module === 'servicios' && (
                            <div className="space-y-4">
                                <h2 className="text-2xl font-bold">‚ö° Servicios y Pagos</h2>
                                
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div className="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                                        <div className="text-2xl font-bold text-green-600">
                                            S/ {servicios.reduce((s,v) => s + v.pagado, 0).toFixed(2)}
                                        </div>
                                        <div className="text-sm text-gray-600">Pagado</div>
                                    </div>
                                    <div className="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                                        <div className="text-2xl font-bold text-red-600">S/ {totalServiciosPendientes.toFixed(2)}</div>
                                        <div className="text-sm text-gray-600">Pendiente</div>
                                    </div>
                                    <div className="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                                        <div className="text-2xl font-bold text-blue-600">
                                            {servicios.filter(s => s.estado === 'PENDIENTE').length}
                                        </div>
                                        <div className="text-sm text-gray-600">Por Pagar</div>
                                    </div>
                                </div>

                                <div className="bg-white rounded-lg shadow overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead className="bg-purple-600 text-white">
                                            <tr>
                                                <th className="p-3 text-left">Servicio</th>
                                                <th className="p-3 text-right">Monto</th>
                                                <th className="p-3 text-right">Pagado</th>
                                                <th className="p-3 text-right">Pendiente</th>
                                                <th className="p-3 text-center">Vencimiento</th>
                                                <th className="p-3 text-center">Estado</th>
                                                <th className="p-3 text-center">Alerta</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {servicios.map(s => (
                                                <tr key={s.id} className="border-b hover:bg-gray-50">
                                                    <td className="p-3 font-semibold">{s.servicio}</td>
                                                    <td className="p-3 text-right">S/ {s.monto.toFixed(2)}</td>
                                                    <td className="p-3 text-right text-green-600 font-bold">S/ {s.pagado.toFixed(2)}</td>
                                                    <td className="p-3 text-right text-red-600 font-bold">S/ {s.pendiente.toFixed(2)}</td>
                                                    <td className="p-3 text-center text-xs">{s.vencimiento}</td>
                                                    <td className="p-3 text-center">
                                                        <span className={`px-2 py-1 rounded text-xs font-bold ${
                                                            s.estado === 'PAGADO' ? 'bg-green-100 text-green-800' :
                                                            s.estado === 'PARCIAL' ? 'bg-yellow-100 text-yellow-800' :
                                                            'bg-red-100 text-red-800'
                                                        }`}>{s.estado}</span>
                                                    </td>
                                                    <td className="p-3 text-center text-xs">{s.alerta}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {/* KDS */}
                        {module === 'kds' && (
                            <div className="space-y-4">
                                <h2 className="text-2xl font-bold">üë®‚Äçüç≥ Kitchen Display System</h2>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    {kds.map(k => (
                                        <div key={k.id} className={`p-4 rounded-lg shadow-lg border-l-4 ${
                                            k.prioridad === 'ALTA' ? 'border-red-500 bg-red-50' :
                                            k.prioridad === 'MEDIA' ? 'border-yellow-500 bg-yellow-50' :
                                            'border-green-500 bg-green-50'
                                        }`}>
                                            <div className="flex justify-between items-start mb-2">
                                                <div>
                                                    <div className="font-bold text-lg">{k.nPedido}</div>
                                                    <div className="text-sm text-gray-600">{k.cliente}</div>
                                                </div>
                                                <span className={`px-2 py-1 rounded text-xs font-bold ${
                                                    k.prioridad === 'ALTA' ? 'bg-red-100 text-red-800' :
                                                    k.prioridad === 'MEDIA' ? 'bg-yellow-100 text-yellow-800' :
                                                    'bg-green-100 text-green-800'
                                                }`}>{k.prioridad}</span>
                                            </div>
                                            <div className="mb-2">
                                                <p className="text-sm font-semibold">{k.productos}</p>
                                                <p className="text-xs text-gray-600">Cantidad: {k.cantidad}</p>
                                            </div>
                                            <div className="flex justify-between items-center text-xs">
                                                <span>üïê {k.hora}</span>
                                                <span className={`px-2 py-1 rounded font-bold ${
                                                    k.estado === 'COMPLETADO' ? 'bg-green-100 text-green-800' :
                                                    k.estado === 'EN PROCESO' ? 'bg-blue-100 text-blue-800' :
                                                    'bg-gray-100 text-gray-800'
                                                }`}>{k.estado}</span>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                                {kds.length === 0 && <p className="text-center text-gray-500 py-8">No hay pedidos en cocina</p>}
                            </div>
                        )}

                        {/* DELIVERY */}
                        {module === 'delivery' && (
                            <div className="space-y-4">
                                <h2 className="text-2xl font-bold">üöó Gesti√≥n de Entregas</h2>
                                <div className="bg-white rounded-lg shadow overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead className="bg-cyan-600 text-white">
                                            <tr>
                                                <th className="p-3 text-left">Fecha</th>
                                                <th className="p-3 text-left">Pedido</th>
                                                <th className="p-3 text-left">Delivery</th>
                                                <th className="p-3 text-left">Destino</th>
                                                <th className="p-3 text-right">Costo</th>
                                                <th className="p-3 text-right">Cobrado</th>
                                                <th className="p-3 text-right">Ganancia</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {delivery.map(d => (
                                                <tr key={d.id} className="border-b hover:bg-gray-50">
                                                    <td className="p-3">{d.fecha}</td>
                                                    <td className="p-3 font-mono text-xs">{d.nPedido}</td>
                                                    <td className="p-3">{d.delivery}</td>
                                                    <td className="p-3">{d.destino}</td>
                                                    <td className="p-3 text-right">S/ {d.costo.toFixed(2)}</td>
                                                    <td className="p-3 text-right text-green-600 font-bold">S/ {d.cobradoCliente.toFixed(2)}</td>
                                                    <td className="p-3 text-right text-blue-600 font-bold">S/ {d.ganancia.toFixed(2)}</td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {/* CUENTAS POR COBRAR */}
                        {module === 'cuentas' && (
                            <div className="space-y-4">
                                <h2 className="text-2xl font-bold">üí≥ Cuentas por Cobrar</h2>
                                
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div className="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                                        <div className="text-2xl font-bold text-red-600">S/ {totalPorCobrar.toFixed(2)}</div>
                                        <div className="text-sm text-gray-600">Total por Cobrar</div>
                                    </div>
                                    <div className="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                                        <div className="text-2xl font-bold text-yellow-600">{cuentasPorCobrar.length}</div>
                                        <div className="text-sm text-gray-600">Cuentas Pendientes</div>
                                    </div>
                                    <div className="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                                        <div className="text-2xl font-bold text-green-600">
                                            S/ {(totalIngresos - totalPorCobrar).toFixed(2)}
                                        </div>
                                        <div className="text-sm text-gray-600">Cobrado</div>
                                    </div>
                                </div>

                                <div className="bg-white rounded-lg shadow overflow-x-auto">
                                    <table className="w-full text-sm">
                                        <thead className="bg-red-600 text-white">
                                            <tr>
                                                <th className="p-3 text-left">Cliente</th>
                                                <th className="p-3 text-left">Pedido</th>
                                                <th className="p-3 text-right">Monto Total</th>
                                                <th className="p-3 text-right">Saldo</th>
                                                <th className="p-3 text-center">Entrega</th>
                                                <th className="p-3 text-center">Estado</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            {cuentasPorCobrar.map(c => (
                                                <tr key={c.id} className="border-b hover:bg-gray-50">
                                                    <td className="p-3">{c.cliente}</td>
                                                    <td className="p-3 font-mono text-xs">{c.nPedido}</td>
                                                    <td className="p-3 text-right">S/ {c.monto.toFixed(2)}</td>
                                                    <td className="p-3 text-right font-bold text-red-600">S/ {c.saldo.toFixed(2)}</td>
                                                    <td className="p-3 text-center text-xs">{c.fechaEntrega}</td>
                                                    <td className="p-3 text-center">
                                                        <span className="px-2 py-1 rounded text-xs bg-yellow-100 text-yellow-800 font-bold">
                                                            PENDIENTE
                                                        </span>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}

                        {/* GR√ÅFICOS */}
                        {module === 'graficos' && (
                            <div className="space-y-6">
                                <h2 className="text-2xl font-bold">üìà An√°lisis Gr√°fico</h2>
                                
                                <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                                    <div className="bg-white p-6 rounded-lg shadow">
                                        <h3 className="font-bold mb-4">Ingresos vs Gastos</h3>
                                        <div style={{height: '300px'}} className="flex items-center justify-center bg-gradient-to-br from-green-50 to-red-50 rounded">
                                            <div className="text-center">
                                                <div className="text-6xl mb-2">üìä</div>
                                                <div className="text-sm font-bold mb-2">Comparativa Financiera</div>
                                                <div className="text-xs text-green-600">Ingresos: S/ {totalIngresos.toFixed(0)}</div>
                                                <div className="text-xs text-red-600">Gastos: S/ {totalGastos.toFixed(0)}</div>
                                                <div className={`text-xs mt-2 font-bold ${balance >= 0 ? 'text-blue-600' : 'text-orange-600'}`}>
                                                    Balance: S/ {balance.toFixed(0)}
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-white p-6 rounded-lg shadow">
                                        <h3 className="font-bold mb-4">Servicios</h3>
                                        <div style={{height: '300px'}} className="flex items-center justify-center bg-gradient-to-br from-green-50 to-red-50 rounded">
                                            <div className="text-center">
                                                <div className="text-6xl mb-2">üí∞</div>
                                                <div className="text-sm font-bold mb-2">Estado de Pagos</div>
                                                <div className="text-xs text-green-600">Pagado: S/ {servicios.reduce((s,v) => s + v.pagado, 0).toFixed(0)}</div>
                                                <div className="text-xs text-red-600">Pendiente: S/ {totalServiciosPendientes.toFixed(0)}</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-white p-6 rounded-lg shadow">
                                        <h3 className="font-bold mb-4">Cuentas por Cobrar</h3>
                                        <div style={{height: '300px'}} className="flex items-center justify-center bg-gradient-to-br from-blue-50 to-purple-50 rounded">
                                            <div className="text-center">
                                                <div className="text-6xl mb-2">üí≥</div>
                                                <div className="text-sm font-bold mb-2">Estado de Cobros</div>
                                                <div className="text-xs text-red-600">Por Cobrar: S/ {totalPorCobrar.toFixed(0)}</div>
                                                <div className="text-xs text-green-600">Cobrado: S/ {(totalIngresos - totalPorCobrar).toFixed(0)}</div>
                                                <div className="text-xs mt-2">{cuentasPorCobrar.length} cuentas pendientes</div>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="bg-white p-6 rounded-lg shadow">
                                        <h3 className="font-bold mb-4">Alertas de Stock</h3>
                                        <div className="space-y-2 max-h-80 overflow-y-auto">
                                            {inventario.filter(i => i.stock <= i.stockMin).slice(0, 10).map(i => (
                                                <div key={i.id} className="flex justify-between items-center p-2 bg-red-50 rounded">
                                                    <span className="text-sm font-semibold">{i.nombre}</span>
                                                    <span className="text-xs bg-red-100 text-red-600 px-2 py-1 rounded font-bold">
                                                        Stock: {i.stock} {i.unidad}
                                                    </span>
                                                </div>
                                            ))}
                                            {inventario.filter(i => i.stock <= i.stockMin).length === 0 && (
                                                <p className="text-center text-gray-500 py-8">‚úÖ Sin alertas de stock</p>
                                            )}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* OCR */}
                        {module === 'ocr' && (
                            <div className="space-y-4">
                                <h2 className="text-2xl font-bold">üì∏ Escanear Factura/Boleta (OCR)</h2>
                                
                                <div className="bg-white p-6 rounded-lg shadow">
                                    <div className="mb-4">
                                        <label className="block text-sm font-bold mb-2">Subir imagen de factura:</label>
                                        <input type="file" accept="image/*" 
                                            onChange={async (e) => {
                                                const file = e.target.files[0];
                                                if (file) await procesarFactura(file);
                                            }}
                                            className="border p-2 rounded w-full" />
                                    </div>
                                    
                                    {ocrLoading && (
                                        <div className="text-center py-8">
                                            <div className="text-6xl mb-2">üîÑ</div>
                                            <div className="font-bold text-lg">Procesando imagen...</div>
                                            <p className="text-sm text-gray-600">Esto puede tardar 10-15 segundos</p>
                                        </div>
                                    )}
                                    
                                    {ocrData && !ocrLoading && (
                                        <div className="bg-green-50 border-l-4 border-green-500 p-4 rounded mt-4">
                                            <div className="font-bold mb-2">‚úÖ Datos Extra√≠dos:</div>
                                            <div className="space-y-1 text-sm">
                                                <p><strong>RUC:</strong> {ocrData.ruc}</p>
                                                <p><strong>Raz√≥n Social:</strong> {ocrData.razonSocial}</p>
                                                <p><strong>Monto:</strong> S/ {ocrData.monto.toFixed(2)}</p>
                                                <p><strong>Fecha:</strong> {ocrData.fecha}</p>
                                            </div>
                                        </div>
                                    )}
                                    
                                    <div className="bg-blue-50 border-l-4 border-blue-500 p-4 rounded mt-4">
                                        <div className="font-bold mb-2">üí° C√≥mo usar:</div>
                                        <ol className="text-sm space-y-1">
                                            <li>1. Toma foto clara de la factura/boleta</li>
                                            <li>2. Aseg√∫rate que el texto se vea n√≠tido</li>
                                            <li>3. Sube la imagen</li>
                                            <li>4. El sistema extraer√°: RUC, Raz√≥n Social, Monto, Fecha</li>
                                            <li>5. Usa los datos para registrar el gasto</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* CONFIG */}
                        {module === 'config' && (
                            <div className="space-y-4">
                                <h2 className="text-2xl font-bold">‚öôÔ∏è Configuraci√≥n</h2>
                                
                                <div className="bg-white p-6 rounded-lg shadow space-y-4">
                                    <div>
                                        <label className="block font-bold mb-2">Google Sheets ID</label>
                                        <input type="text" value={config.sheetId} 
                                            onChange={(e) => setConfig({...config, sheetId: e.target.value})}
                                            className="w-full p-3 border rounded-lg" 
                                            placeholder="1oUulLDJ6K-VF3TDLYypa_ggexr0h6qfRtL4k1IM-Xws" />
                                        <p className="text-xs text-gray-600 mt-1">De la URL: docs.google.com/spreadsheets/d/<strong>ESTE_ID</strong>/edit</p>
                                    </div>
                                    
                                    <div>
                                        <label className="block font-bold mb-2">Google API Key</label>
                                        <input type="text" value={config.apiKey}
                                            onChange={(e) => setConfig({...config, apiKey: e.target.value})}
                                            className="w-full p-3 border rounded-lg" 
                                            placeholder="AIzaSy..." />
                                        <p className="text-xs text-gray-600 mt-1">Crear en: console.cloud.google.com/apis/credentials</p>
                                    </div>
                                    
                                    <button onClick={() => {
                                        localStorage.setItem('sheets_id', config.sheetId);
                                        localStorage.setItem('api_key', config.apiKey);
                                        alert('‚úÖ Configuraci√≥n guardada');
                                    }} className="w-full bg-indigo-600 text-white py-3 rounded-lg font-bold hover:bg-indigo-700 transition">
                                        üíæ Guardar Configuraci√≥n
                                    </button>
                                </div>

                                <div className="bg-gradient-to-r from-indigo-50 to-purple-50 border-l-4 border-indigo-500 p-6 rounded">
                                    <div className="font-bold mb-3 text-lg">üéØ Sistema ERP SUPER COMPLETO</div>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-2 text-sm">
                                        <div>
                                            <p className="font-bold mb-1">üìä M√≥dulos Base:</p>
                                            <ul className="space-y-1">
                                                <li>‚úÖ Dashboard con 8 tarjetas</li>
                                                <li>‚úÖ Ingresos/Ventas</li>
                                                <li>‚úÖ Gastos</li>
                                                <li>‚úÖ Personal</li>
                                                <li>‚úÖ Clientes</li>
                                                <li>‚úÖ Inventario</li>
                                                <li>‚úÖ Productos</li>
                                                <li>‚úÖ Proveedores</li>
                                                <li>‚úÖ Servicios</li>
                                                <li>‚úÖ KDS (Cocina)</li>
                                                <li>‚úÖ Delivery</li>
                                            </ul>
                                        </div>
                                        <div>
                                            <p className="font-bold mb-1">üÜï Funciones Avanzadas:</p>
                                            <ul className="space-y-1">
                                                <li>‚úÖ OCR: Escanear facturas</li>
                                                <li>‚úÖ Filtros: RUC / Cuenta Principal</li>
                                                <li>‚úÖ Cuentas por Cobrar</li>
                                                <li>‚úÖ Inventario: muestra productos que usan cada insumo</li>
                                                <li>‚úÖ Gr√°ficos de an√°lisis</li>
                                                <li>‚úÖ Rankings de vendedoras</li>
                                                <li>‚úÖ Rankings de distritos</li>
                                                <li>‚úÖ Gastos por categor√≠a</li>
                                                <li>‚úÖ Alertas de stock bajo</li>
                                                <li>‚úÖ Servicios con estado detallado</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<ERP />, document.getElementById('root'));
    </script>
</body>
</html>
